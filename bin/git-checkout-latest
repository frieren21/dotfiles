#!/usr/bin/env bash

set -e
set -x

main="$(git main-branch)"
latest="$(git latest)"
git checkout "${latest}"

if [[ "${latest}" == "${main}" ]]; then
    git branch -q --set-upstream-to="origin/${latest}"
    git pull -q --rebase --autostash
fi

git submodule update --no-fetch --checkout --recursive
